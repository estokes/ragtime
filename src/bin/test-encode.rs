use anyhow::Result;
use ragtime::EmbedDb;

const BASE: &str = "/home/eric/proj/bge-m3/onnx";
const ESIZE: usize = 1024; // the size of the sentence embedding generated by the model

pub fn main() -> Result<()> {
    tracing_subscriber::fmt::init();
    ort::init().commit()?;
    let mut edb = EmbedDb::new(
        &format!("{BASE}/model.onnx"),
        &format!("{BASE}/tokenizer.json"),
        ESIZE,
    )?;
    edb.add(vec![
        "I've got a lovely bunch of coconuts".into(),
        "I like coconuts very much".into(),
        "A goomba is a character from super mario bros".into(),
    ])?;
    let m = edb.search("who here likes coconuts?".into(), 2)?;
    println!("{m:?}");
    Ok(())
}
